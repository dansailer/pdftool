{% assign t = site.data[page.lang] %}
{% assign current_lang = page.lang | default: 'en' %}

<div class="language-switcher">
  <button class="lang-toggle" aria-label="{{ t.ui.switch_language }}">
    <span class="lang-icon">üåê</span>
    <span class="lang-current">{{ site.language_names[current_lang] }}</span>
    <span class="lang-arrow">‚ñº</span>
  </button>
  <ul class="lang-dropdown">
    {% for lang in site.languages %}
    {% assign lang_name = site.language_names[lang] %}
    {% assign current_path = page.url | remove: '/' | append: page.lang | remove: page.lang %}
    {% assign page_path = page.url | replace: current_lang, lang %}
    <li {% if lang == current_lang %}class="active"{% endif %}>
      <a href="{{ page_path | relative_url }}">{{ lang_name }}</a>
    </li>
    {% endfor %}
  </ul>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const switcher = document.querySelector('.language-switcher');
  const toggle = switcher.querySelector('.lang-toggle');
  const dropdown = switcher.querySelector('.lang-dropdown');
  
  toggle.addEventListener('click', function(e) {
    e.stopPropagation();
    dropdown.classList.toggle('show');
  });
  
  document.addEventListener('click', function() {
    dropdown.classList.remove('show');
  });
});
</script>
